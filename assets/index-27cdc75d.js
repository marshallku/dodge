var ut=Object.defineProperty;var ft=(r,e,t)=>e in r?ut(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var w=(r,e,t)=>(ft(r,typeof e!="symbol"?e+"":e,t),t),j=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var i=(r,e,t)=>(j(r,e,"read from private field"),t?t.call(r):e.get(r)),n=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},h=(r,e,t,s)=>(j(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t);var l=(r,e,t)=>(j(r,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var x,$,J;class yt{constructor(e=500,t=500){n(this,$);w(this,"width");w(this,"height");n(this,x,void 0);const s=document.createElement("canvas");this.width=e,this.height=t,h(this,x,s),l(this,$,J).call(this)}render(e=document.body){e.append(i(this,x))}destroy(){i(this,x).remove()}clear(){this.getContext().clearRect(0,0,this.width,this.height)}getCanvas(){return i(this,x)}getContext(){const e=i(this,x).getContext("2d");if(!e)throw new Error("Context doesn't exist");return e}setSize(e,t){this.width=e,this.height=t,l(this,$,J).call(this)}}x=new WeakMap,$=new WeakSet,J=function(){i(this,x).width=this.width,i(this,x).height=this.height};class ht{constructor({x:e=0,y:t=0,size:s=1,lineWidth:o=1,color:c="black"}={}){w(this,"x");w(this,"y");w(this,"size");w(this,"lineWidth");w(this,"color");this.x=e,this.y=t,this.size=s,this.lineWidth=o,this.color=c}render(e){throw new Error("Implement render method")}update({x:e,y:t}){this.x=e,this.y=t}move({x:e,y:t},s){if(s){this.x=Math.min(Math.max(0,this.x+e),s.x-this.size),this.y=Math.min(Math.max(0,this.y+t),s.y-this.size);return}this.x+=e,this.y+=t}getVisibility(e){return!(this.x<-this.size||e.width+this.size<this.x||this.y<-this.size||e.height+this.size<this.y)}checkCollision(e){return this.x+this.size>=e.x&&this.x<=e.x+e.size&&this.y+this.size>=e.y&&this.y<=e.y+e.size}}class mt extends ht{constructor(e){super(e)}render(e){const t=Math.ceil(this.lineWidth/2);e.beginPath(),e.lineWidth=this.lineWidth,e.strokeStyle=this.color,e.arc(this.x+t,this.y+t,this.size/2,0,2*Math.PI),e.stroke()}}var B,N;class ot extends mt{constructor(t={}){super(t);n(this,B,void 0);n(this,N,void 0);h(this,B,t.xAcceleration||1),h(this,N,t.yAcceleration||1)}moveTo(t){super.move({x:i(this,B)*t,y:i(this,N)*t})}}B=new WeakMap,N=new WeakMap;const pt="/dodge/assets/star-82675554.svg";var F,g,S,P,O,A,v,D,Y,nt;class xt extends ht{constructor({canvasSize:t,boundary:s}){super({x:t/2-8/2,y:t/2-8/2,size:8,color:"red"});n(this,Y);n(this,F,void 0);n(this,g,void 0);n(this,S,void 0);n(this,P,void 0);n(this,O,void 0);n(this,A,void 0);n(this,v,void 0);n(this,D,void 0);w(this,"useKeyboard");h(this,O,t),h(this,v,8),h(this,g,200),h(this,A,s);const c=["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"];h(this,S,{ArrowUp:!1,ArrowRight:!1,ArrowDown:!1,ArrowLeft:!1}),h(this,P,c),h(this,D,{x:0,y:0}),h(this,F,new Image(8,8)),i(this,F).src=pt,this.useKeyboard=!1}resetPosition(){super.update({x:i(this,O)/2-i(this,v)/2,y:i(this,O)/2-i(this,v)/2})}render(t){t.drawImage(i(this,F),this.x-i(this,v)/2,this.y-i(this,v)/2,i(this,v)*2,i(this,v)*2)}moveTo(t){this.useKeyboard||this.moveDirections(t);const{ArrowUp:s,ArrowRight:o,ArrowDown:c,ArrowLeft:u}=i(this,S);s&&this.moveUp(t),o&&this.moveRight(t),c&&this.moveDown(t),u&&this.moveLeft(t)}moveUp(t){super.move({x:0,y:Math.min(-i(this,g))*t},i(this,A))}moveRight(t){super.move({x:i(this,g)*t,y:0},i(this,A))}moveDown(t){super.move({x:0,y:i(this,g)*t},i(this,A))}moveLeft(t){super.move({x:-i(this,g)*t,y:0},i(this,A))}moveDirections(t){const{x:s,y:o}=i(this,D);super.move({x:s*i(this,g)*t,y:o*i(this,g)*t},i(this,A))}bindEvents(){document.addEventListener("keydown",({key:t})=>{i(this,P).includes(t)&&(i(this,S)[t]=!0)}),document.addEventListener("keyup",({key:t})=>{i(this,P).includes(t)&&(i(this,S)[t]=!1)}),window.addEventListener("deviceorientation",l(this,Y,nt).bind(this),{passive:!0})}}F=new WeakMap,g=new WeakMap,S=new WeakMap,P=new WeakMap,O=new WeakMap,A=new WeakMap,v=new WeakMap,D=new WeakMap,Y=new WeakSet,nt=function({beta:t,gamma:s}){if(t==null||s==null)return;const o=3,c=50,u=Math.min(1,Math.max(s/90,-1))*o,a=Math.min(1,Math.max((t-c)/180,-1))*o;h(this,D,{x:u,y:a})};function R(r=0,e=1){const t=Math.ceil(r),s=Math.floor(e);return Math.floor(Math.random()*(s-t+1)+t)}function q(){return Math.random()<.5}const f=500;var U,C,d,y,p,z,b,L,M,E,W,_,rt,X,ct,k,Q,I,G,Z,at,T,tt,K,H,V,et;class gt{constructor(){n(this,_);n(this,X);n(this,k);n(this,I);n(this,Z);n(this,T);n(this,K);n(this,V);n(this,U,void 0);n(this,C,void 0);n(this,d,void 0);n(this,y,void 0);n(this,p,void 0);n(this,z,void 0);n(this,b,void 0);n(this,L,void 0);n(this,M,void 0);n(this,E,void 0);n(this,W,void 0);const e=new yt(f,f);h(this,U,document.getElementById("app")),h(this,b,!0),h(this,W,!1),h(this,C,e),h(this,d,e.getContext()),e.render(i(this,U)),h(this,y,new xt({canvasSize:f,boundary:{x:f,y:f}})),i(this,y).bindEvents(),l(this,V,et).call(this,"DODGE","Press space or click to start"),document.addEventListener("keydown",l(this,_,rt).bind(this)),document.addEventListener("click",l(this,X,ct).bind(this)),h(this,p,[]),h(this,z,[]),h(this,L,0),h(this,M,0),h(this,E,0)}}U=new WeakMap,C=new WeakMap,d=new WeakMap,y=new WeakMap,p=new WeakMap,z=new WeakMap,b=new WeakMap,L=new WeakMap,M=new WeakMap,E=new WeakMap,W=new WeakMap,_=new WeakSet,rt=function({key:e}){e!==" "||!i(this,b)||(i(this,y).useKeyboard=!0,l(this,k,Q).call(this))},X=new WeakSet,ct=function(){i(this,b)&&(i(this,y).useKeyboard=!1,l(this,k,Q).call(this))},k=new WeakSet,Q=function(){i(this,y).resetPosition(),h(this,b,!1),h(this,E,0),h(this,L,0),h(this,M,0),h(this,p,[...Array(f/10)].map(l(this,I,G))),h(this,z,[]),l(this,K,H).call(this,0)},I=new WeakSet,G=function(){const e=q(),t=2,s=R(0,500),o=e?f+t:-t,c=q(),u=c?s:o,a=c?o:s,m=f/2;return new ot({x:u,y:a,size:t,xAcceleration:R(1e3,2e3)/10*(u<m?1:-1),yAcceleration:R(1e3,2e3)/10*(a<m?1:-1),color:"#FF8551"})},Z=new WeakSet,at=function(){const e=q(),t=2,s=R(0,500),o=e?f+t:-t,c=q(),u=i(this,y).x,a=i(this,y).y,m=c?s:o,it=c?o:s,st=R(80,120)/100,lt=(u-m)/st,dt=(a-it)/st;return new ot({x:m,y:it,size:t,xAcceleration:lt,yAcceleration:dt,color:"#9AC5F4"})},T=new WeakSet,tt=function(e,t){const s=e.checkCollision(i(this,y));e.moveTo(t),e.render(i(this,d)),s&&!i(this,W)&&h(this,b,!0)},K=new WeakSet,H=function(e,t=!1){if(i(this,b)){l(this,V,et).call(this,"Game Over","Press space or click to retry");return}const s=(t?0:e-i(this,M))/1e3;if(h(this,M,e),e===0||i(this,M)===0){window.requestAnimationFrame(a=>l(this,K,H).call(this,a,!0));return}t&&h(this,L,e),window.requestAnimationFrame(l(this,K,H).bind(this)),i(this,C).clear();const o=(e-i(this,L))/1e3,c=12,u="Helvetica, Arial, sans-serif";i(this,d).font=`${c}px ${u}`,i(this,d).fillStyle="white",i(this,d).textAlign="left",i(this,d).fillText(`${i(this,p).length} bullets`,10,f-10,f),i(this,d).textAlign="right",i(this,d).fillText(`${o.toFixed(2)}s`,f-10,f-10),i(this,y).moveTo(s),i(this,y).render(i(this,d)),2<=o-i(this,E)&&(h(this,E,o),i(this,p).push(l(this,I,G).call(this)),i(this,z).push(l(this,Z,at).call(this)));for(let a=i(this,p).length-1;0<=a;--a){const m=i(this,p)[a];l(this,T,tt).call(this,m,s),m.getVisibility(i(this,C))||(i(this,p).splice(a,1),i(this,p).push(l(this,I,G).call(this)))}for(let a=i(this,z).length-1;0<=a;--a){const m=i(this,z)[a];l(this,T,tt).call(this,m,s),m.getVisibility(i(this,C))||i(this,z).splice(a,1)}},V=new WeakSet,et=function(e,t){const s="Helvetica, Arial, sans-serif";i(this,d).textAlign="center",i(this,d).fillStyle="white";const o=32,c=1.5,u=f/2-o*c;i(this,d).font=`${o}px ${s}`,i(this,d).fillText(e,f/2,u),t&&(i(this,d).font=`16px ${s}`,i(this,d).fillText(t,f/2,u+o*c))};new gt;
